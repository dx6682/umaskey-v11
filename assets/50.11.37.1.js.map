{"version":3,"sources":["webpack:///./src/client/app/common/views/components/autocomplete.vue?768d","webpack:///./src/client/app/common/views/components/autocomplete.vue?1fa7","webpack:///./src/client/app/common/scripts/contains.ts","webpack:///./src/client/app/common/views/components/autocomplete.vue?cea0","webpack:///./src/client/app/common/views/components/autocomplete.vue?235b","webpack:///./src/client/app/common/views/components/autocomplete.vue?84a6","webpack:///./src/client/app/common/views/components/autocomplete.vue","webpack:///./src/client/app/common/views/components/autocomplete.vue?c018"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA,kCAAkC,mBAAO,CAAC,oHAA+D;AACzG;AACA;AACA,cAAc,QAAS,qCAAqC,eAAe,cAAc,eAAe,2BAA2B,gBAAgB,6BAA6B,gCAAgC,kBAAkB,sCAAsC,qCAAqC,cAAc,SAAS,cAAc,iBAAiB,gBAAgB,cAAc,gBAAgB,wCAAwC,aAAa,mBAAmB,iBAAiB,mBAAmB,gBAAgB,eAAe,qBAAqB,eAAe,kFAAkF,iBAAiB,0CAA0C,gBAAgB,uBAAuB,8CAA8C,0CAA0C,4DAA4D,0BAA0B,0HAA0H,qBAAqB,+CAA+C,kCAAkC,gGAAgG,qBAAqB,oDAAoD,eAAe,gBAAgB,eAAe,gBAAgB,iBAAiB,mBAAmB,kDAAkD,iBAAiB,kCAAkC,sDAAsD,qCAAqC,qDAAqD,kCAAkC,oDAAoD,qBAAqB,iBAAiB,WAAW,wDAAwD,WAAW,sBAAsB,mDAAmD,kCAAkC,oDAAoD,iBAAiB,qCAAqC;AACjiE;AACA;;;;;;;;;;;;;ACNA;;AAEA;AACA,cAAc,mBAAO,CAAC,u1BAAse;AAC5f,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,sIAAyE;AAC3F,+CAA+C;AAC/C;AACA,GAAG,KAAU,EAAE,E;;;;;;;;;;;;ACVf;AAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAC;;;;;;;;;;;;;;;;;;;;;;ACRF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa,wCAAwC;AACrD;AACA;AACA;AACA;AACA,0BAA0B,iBAAiB;AAC3C;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,4BAA4B;AAC5B,mBAAmB;AACnB;AACA;AACA,qBAAqB,sBAAsB;AAC3C;AACA;AACA;AACA,gCAAgC;AAChC,uBAAuB;AACvB;AACA;AACA;AACA,8BAA8B,0BAA0B;AACxD;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,2CAA2C;AACxD;AACA;AACA;AACA;AACA,0BAA0B,iBAAiB;AAC3C;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,iBAAiB;AACjB,6BAA6B,sBAAsB;AACnD;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,yCAAyC;AACtD;AACA;AACA;AACA;AACA,0BAA0B,iBAAiB;AAC3C;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,kCAAkC,uBAAuB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,kCAAkC,uBAAuB;AACzD;AACA,kCAAkC;AAClC,yBAAyB;AACzB;AACA,kCAAkC,uBAAuB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA,kCAAkC,uBAAuB;AACzD;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;AC5IsB;AACoC;AACF;AACU;AACe;AACjF,YAAY,sBAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8BAAc,CAAC,GAAG,kBAAkB;AAChD,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,8BAAc,CAAC,GAAG,kBAAkB;AAC5D,aAAa;AACb;AACA;AACA;AACA;AACe,mGAAG;AAClB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA,YAAY,4DAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,YAAY,iCAAS;AACrB;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,2DAA2D,aAAa;AACxE;AACA;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,mCAAmC,OAAO;AAC1C;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,OAAO;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,OAAO;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT;AACA,iBAAiB,2BAAQ;AACzB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,EAAC;;;ACvS2Q,CAAgB,wHAAG,EAAC,C;;;;;;;;ACA3L;AACvC;AACL;AACwC;;;AAGnG;AACsG;AACtG,gBAAgB,sCAAU;AAC1B,EAAE,+CAAM;AACR,EAAE,MAAM;AACR,EAAE,eAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,mG;;;;;;;;;;;;;ACvCf;AAAA;AAAA;AAAA;AAAgjB,CAAgB,+fAAG,EAAC,C","file":"50.11.37.1.js","sourcesContent":["// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".mk-autocomplete[data-v-77c5e7a5]{position:fixed;z-index:65535;max-width:100%;margin-top:calc(1em + 8px);overflow:hidden;background:var(--faceHeader);border:1px solid rgba(0,0,0,.1);border-radius:4px;transition:top .1s ease,left .1s ease}.mk-autocomplete>ol[data-v-77c5e7a5]{display:block;margin:0;padding:4px 0;max-height:190px;max-width:500px;overflow:auto;list-style:none}.mk-autocomplete>ol>li[data-v-77c5e7a5]{display:flex;align-items:center;padding:4px 12px;white-space:nowrap;overflow:hidden;font-size:.9em;color:rgba(0,0,0,.8);cursor:default}.mk-autocomplete>ol>li[data-v-77c5e7a5],.mk-autocomplete>ol>li *[data-v-77c5e7a5]{user-select:none}.mk-autocomplete>ol>li *[data-v-77c5e7a5]{overflow:hidden;text-overflow:ellipsis}.mk-autocomplete>ol>li[data-v-77c5e7a5]:hover{background:var(--autocompleteItemHoverBg)}.mk-autocomplete>ol>li[data-selected=true][data-v-77c5e7a5]{background:var(--primary)}.mk-autocomplete>ol>li[data-selected=true][data-v-77c5e7a5],.mk-autocomplete>ol>li[data-selected=true] *[data-v-77c5e7a5]{color:#fff!important}.mk-autocomplete>ol>li[data-v-77c5e7a5]:active{background:var(--primaryDarken10)}.mk-autocomplete>ol>li[data-v-77c5e7a5]:active,.mk-autocomplete>ol>li:active *[data-v-77c5e7a5]{color:#fff!important}.mk-autocomplete>.users>li .avatar[data-v-77c5e7a5]{min-width:28px;min-height:28px;max-width:28px;max-height:28px;margin:0 8px 0 0;border-radius:100%}.mk-autocomplete>.users>li .name[data-v-77c5e7a5]{margin:0 8px 0 0;color:var(--autocompleteItemText)}.mk-autocomplete>.users>li .username[data-v-77c5e7a5]{color:var(--autocompleteItemTextSub)}.mk-autocomplete>.hashtags>li .name[data-v-77c5e7a5]{color:var(--autocompleteItemText)}.mk-autocomplete>.emojis>li .emoji[data-v-77c5e7a5]{display:inline-block;margin:0 4px 0 0;width:24px}.mk-autocomplete>.emojis>li .emoji>img[data-v-77c5e7a5]{width:24px;vertical-align:bottom}.mk-autocomplete>.emojis>li .name[data-v-77c5e7a5]{color:var(--autocompleteItemText)}.mk-autocomplete>.emojis>li .alias[data-v-77c5e7a5]{margin:0 0 0 8px;color:var(--autocompleteItemTextSub)}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../node_modules/stylus-loader/index.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./autocomplete.vue?vue&type=style&index=0&id=77c5e7a5&lang=stylus&scoped=true&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"7d2b7af1\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../node_modules/stylus-loader/index.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./autocomplete.vue?vue&type=style&index=0&id=77c5e7a5&lang=stylus&scoped=true&\", function() {\n     var newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../node_modules/stylus-loader/index.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./autocomplete.vue?vue&type=style&index=0&id=77c5e7a5&lang=stylus&scoped=true&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","export default (parent, child) => {\n    let node = child.parentNode;\n    while (node) {\n        if (node == parent)\n            return true;\n        node = node.parentNode;\n    }\n    return false;\n};\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"mk-autocomplete\",\n      on: {\n        contextmenu: function($event) {\n          $event.preventDefault()\n          return (function() {})($event)\n        }\n      }\n    },\n    [\n      _vm.users.length > 0\n        ? _c(\n            \"ol\",\n            { ref: \"suggests\", staticClass: \"users\" },\n            _vm._l(_vm.users, function(user) {\n              return _c(\n                \"li\",\n                {\n                  attrs: { tabindex: \"-1\" },\n                  on: {\n                    click: function($event) {\n                      return _vm.complete(_vm.type, user)\n                    },\n                    keydown: _vm.onKeydown\n                  }\n                },\n                [\n                  _c(\"img\", {\n                    staticClass: \"avatar\",\n                    attrs: { src: user.avatarUrl, alt: \"\" }\n                  }),\n                  _c(\n                    \"span\",\n                    { staticClass: \"name\" },\n                    [\n                      _c(\"mk-user-name\", {\n                        key: user.id,\n                        attrs: { user: user }\n                      })\n                    ],\n                    1\n                  ),\n                  _c(\"span\", { staticClass: \"username\" }, [\n                    _vm._v(\"@\" + _vm._s(_vm._f(\"acct\")(user)))\n                  ])\n                ]\n              )\n            }),\n            0\n          )\n        : _vm._e(),\n      _vm.hashtags.length > 0\n        ? _c(\n            \"ol\",\n            { ref: \"suggests\", staticClass: \"hashtags\" },\n            _vm._l(_vm.hashtags, function(hashtag) {\n              return _c(\n                \"li\",\n                {\n                  attrs: { tabindex: \"-1\" },\n                  on: {\n                    click: function($event) {\n                      return _vm.complete(_vm.type, hashtag)\n                    },\n                    keydown: _vm.onKeydown\n                  }\n                },\n                [_c(\"span\", { staticClass: \"name\" }, [_vm._v(_vm._s(hashtag))])]\n              )\n            }),\n            0\n          )\n        : _vm._e(),\n      _vm.emojis.length > 0\n        ? _c(\n            \"ol\",\n            { ref: \"suggests\", staticClass: \"emojis\" },\n            _vm._l(_vm.emojis, function(emoji) {\n              return _c(\n                \"li\",\n                {\n                  attrs: { tabindex: \"-1\" },\n                  on: {\n                    click: function($event) {\n                      return _vm.complete(_vm.type, emoji.emoji)\n                    },\n                    keydown: _vm.onKeydown\n                  }\n                },\n                [\n                  emoji.isCustomEmoji\n                    ? _c(\"span\", { staticClass: \"emoji\" }, [\n                        _c(\"img\", {\n                          attrs: {\n                            src: _vm.$store.state.device\n                              .disableShowingAnimatedImages\n                              ? _vm.getStaticImageUrl(emoji.url)\n                              : emoji.url,\n                            alt: emoji.emoji\n                          }\n                        })\n                      ])\n                    : !_vm.useOsDefaultEmojis\n                    ? _c(\"span\", { staticClass: \"emoji\" }, [\n                        _c(\"img\", {\n                          attrs: { src: emoji.url, alt: emoji.emoji }\n                        })\n                      ])\n                    : _c(\"span\", { staticClass: \"emoji\" }, [\n                        _vm._v(_vm._s(emoji.emoji))\n                      ]),\n                  _c(\"span\", {\n                    staticClass: \"name\",\n                    domProps: {\n                      innerHTML: _vm._s(\n                        emoji.name.replace(_vm.q, \"<b>\" + _vm.q + \"</b>\")\n                      )\n                    }\n                  }),\n                  emoji.aliasOf\n                    ? _c(\"span\", { staticClass: \"alias\" }, [\n                        _vm._v(\"(\" + _vm._s(emoji.aliasOf) + \")\")\n                      ])\n                    : _vm._e()\n                ]\n              )\n            }),\n            0\n          )\n        : _vm._e()\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import Vue from 'vue';\nimport { emojilist } from '../../../../../misc/emojilist';\nimport contains from '../../../common/scripts/contains';\nimport { twemojiSvgBase } from '../../../../../misc/twemoji-base';\nimport { getStaticImageUrl } from '../../../common/scripts/get-static-image-url';\nconst lib = emojilist.filter(x => x.category !== 'flags');\nconst char2file = (char) => {\n    let codes = Array.from(char).map(x => x.codePointAt(0).toString(16));\n    if (!codes.includes('200d'))\n        codes = codes.filter(x => x != 'fe0f');\n    codes = codes.filter(x => x && x.length);\n    return codes.join('-');\n};\nconst emjdb = lib.map(x => ({\n    emoji: x.char,\n    name: x.name,\n    aliasOf: null,\n    url: `${twemojiSvgBase}/${char2file(x.char)}.svg`\n}));\nfor (const x of lib) {\n    if (x.keywords) {\n        for (const k of x.keywords) {\n            emjdb.push({\n                emoji: x.char,\n                name: k,\n                aliasOf: x.name,\n                url: `${twemojiSvgBase}/${char2file(x.char)}.svg`\n            });\n        }\n    }\n}\nemjdb.sort((a, b) => a.name.length - b.name.length);\nexport default Vue.extend({\n    props: {\n        type: {\n            type: String,\n            required: true,\n        },\n        q: {\n            type: String,\n            required: true,\n        },\n        textarea: {\n            type: Object,\n            required: true,\n        },\n        complete: {\n            type: Function,\n            required: true,\n        },\n        close: {\n            type: Function,\n            required: true,\n        },\n        x: {\n            type: Number,\n            required: true,\n        },\n        y: {\n            type: Number,\n            required: true,\n        },\n    },\n    data() {\n        return {\n            getStaticImageUrl,\n            fetching: true,\n            users: [],\n            hashtags: [],\n            emojis: [],\n            select: -1,\n            emojilist,\n            emojiDb: []\n        };\n    },\n    computed: {\n        items() {\n            return this.$refs.suggests.children;\n        },\n        useOsDefaultEmojis() {\n            return this.$store.state.device.useOsDefaultEmojis;\n        }\n    },\n    updated() {\n        //#region 位置調整\n        if (this.x + this.$el.offsetWidth > window.innerWidth) {\n            this.$el.style.left = (window.innerWidth - this.$el.offsetWidth) + 'px';\n        }\n        else {\n            this.$el.style.left = this.x + 'px';\n        }\n        if (this.y + this.$el.offsetHeight > window.innerHeight) {\n            this.$el.style.top = (this.y - this.$el.offsetHeight) + 'px';\n            this.$el.style.marginTop = '0';\n        }\n        else {\n            this.$el.style.top = this.y + 'px';\n            this.$el.style.marginTop = 'calc(1em + 8px)';\n        }\n        //#endregion\n    },\n    mounted() {\n        //#region Construct Emoji DB\n        const customEmojis = (this.$root.getMetaSync() || { emojis: [] }).emojis || [];\n        const emojiDefinitions = [];\n        for (const x of customEmojis) {\n            emojiDefinitions.push({\n                name: x.name,\n                emoji: `:${x.name}:`,\n                url: x.url,\n                isCustomEmoji: true\n            });\n            if (x.aliases) {\n                for (const alias of x.aliases) {\n                    emojiDefinitions.push({\n                        name: alias,\n                        aliasOf: x.name,\n                        emoji: `:${x.name}:`,\n                        url: x.url,\n                        isCustomEmoji: true\n                    });\n                }\n            }\n        }\n        emojiDefinitions.sort((a, b) => a.name.length - b.name.length);\n        this.emojiDb = emojiDefinitions.concat(emjdb);\n        //#endregion\n        this.textarea.addEventListener('keydown', this.onKeydown);\n        for (const el of Array.from(document.querySelectorAll('body *'))) {\n            el.addEventListener('mousedown', this.onMousedown);\n        }\n        this.$nextTick(() => {\n            this.exec();\n            this.$watch('q', () => {\n                this.$nextTick(() => {\n                    this.exec();\n                });\n            });\n        });\n    },\n    beforeDestroy() {\n        this.textarea.removeEventListener('keydown', this.onKeydown);\n        for (const el of Array.from(document.querySelectorAll('body *'))) {\n            el.removeEventListener('mousedown', this.onMousedown);\n        }\n    },\n    methods: {\n        exec() {\n            this.select = -1;\n            if (this.$refs.suggests) {\n                for (const el of Array.from(this.items)) {\n                    el.removeAttribute('data-selected');\n                }\n            }\n            if (this.type == 'user') {\n                const cacheKey = `autocomplete:user:${this.q}`;\n                const cache = sessionStorage.getItem(cacheKey);\n                if (cache) {\n                    const users = JSON.parse(cache);\n                    this.users = users;\n                    this.fetching = false;\n                }\n                else {\n                    this.$root.api('users/search', {\n                        query: this.q,\n                        limit: 10,\n                        detail: false\n                    }).then(users => {\n                        this.users = users;\n                        this.fetching = false;\n                        // キャッシュ\n                        sessionStorage.setItem(cacheKey, JSON.stringify(users));\n                    });\n                }\n            }\n            else if (this.type == 'hashtag') {\n                if (this.q == null || this.q == '') {\n                    this.hashtags = JSON.parse(localStorage.getItem('hashtags') || '[]');\n                    this.fetching = false;\n                }\n                else {\n                    const cacheKey = `autocomplete:hashtag:${this.q}`;\n                    const cache = sessionStorage.getItem(cacheKey);\n                    if (cache) {\n                        const hashtags = JSON.parse(cache);\n                        this.hashtags = hashtags;\n                        this.fetching = false;\n                    }\n                    else {\n                        this.$root.api('hashtags/search', {\n                            query: this.q,\n                            limit: 30\n                        }).then(hashtags => {\n                            this.hashtags = hashtags;\n                            this.fetching = false;\n                            // キャッシュ\n                            sessionStorage.setItem(cacheKey, JSON.stringify(hashtags));\n                        });\n                    }\n                }\n            }\n            else if (this.type == 'emoji') {\n                if (this.q == null || this.q == '') {\n                    this.emojis = this.emojiDb.filter(x => x.isCustomEmoji && !x.aliasOf).sort((a, b) => {\n                        var textA = a.name.toUpperCase();\n                        var textB = b.name.toUpperCase();\n                        return (textA < textB) ? -1 : (textA > textB) ? 1 : 0;\n                    });\n                    return;\n                }\n                const matched = [];\n                const max = 30;\n                this.emojiDb.some(x => {\n                    if (x.name.startsWith(this.q) && !x.aliasOf && !matched.some(y => y.emoji == x.emoji))\n                        matched.push(x);\n                    return matched.length == max;\n                });\n                if (matched.length < max) {\n                    this.emojiDb.some(x => {\n                        if (x.name.startsWith(this.q) && !matched.some(y => y.emoji == x.emoji))\n                            matched.push(x);\n                        return matched.length == max;\n                    });\n                }\n                if (matched.length < max) {\n                    this.emojiDb.some(x => {\n                        if (x.name.includes(this.q) && !matched.some(y => y.emoji == x.emoji))\n                            matched.push(x);\n                        return matched.length == max;\n                    });\n                }\n                this.emojis = matched;\n            }\n        },\n        onMousedown(e) {\n            if (!contains(this.$el, e.target) && (this.$el != e.target))\n                this.close();\n        },\n        onKeydown(e) {\n            const cancel = () => {\n                e.preventDefault();\n                e.stopPropagation();\n            };\n            switch (e.which) {\n                case 10: // [ENTER]\n                case 13: // [ENTER]\n                    if (this.select !== -1) {\n                        cancel();\n                        this.items[this.select].click();\n                    }\n                    else {\n                        this.close();\n                    }\n                    break;\n                case 27: // [ESC]\n                    cancel();\n                    this.close();\n                    break;\n                case 38: // [↑]\n                    if (this.select !== -1) {\n                        cancel();\n                        this.selectPrev();\n                    }\n                    else {\n                        this.close();\n                    }\n                    break;\n                case 9: // [TAB]\n                case 40: // [↓]\n                    cancel();\n                    this.selectNext();\n                    break;\n                default:\n                    e.stopPropagation();\n                    this.textarea.focus();\n            }\n        },\n        selectNext() {\n            if (++this.select >= this.items.length)\n                this.select = 0;\n            this.applySelect();\n        },\n        selectPrev() {\n            if (--this.select < 0)\n                this.select = this.items.length - 1;\n            this.applySelect();\n        },\n        applySelect() {\n            for (const el of Array.from(this.items)) {\n                el.removeAttribute('data-selected');\n            }\n            this.items[this.select].setAttribute('data-selected', 'true');\n            this.items[this.select].focus();\n        }\n    }\n});\n","import mod from \"-!../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./autocomplete.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./autocomplete.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./autocomplete.vue?vue&type=template&id=77c5e7a5&scoped=true&\"\nimport script from \"./autocomplete.vue?vue&type=script&lang=ts&\"\nexport * from \"./autocomplete.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./autocomplete.vue?vue&type=style&index=0&id=77c5e7a5&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"77c5e7a5\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/ubuntu/uma/misskey/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('77c5e7a5')) {\n      api.createRecord('77c5e7a5', component.options)\n    } else {\n      api.reload('77c5e7a5', component.options)\n    }\n    module.hot.accept(\"./autocomplete.vue?vue&type=template&id=77c5e7a5&scoped=true&\", function () {\n      api.rerender('77c5e7a5', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/client/app/common/views/components/autocomplete.vue\"\nexport default component.exports","import mod from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../node_modules/stylus-loader/index.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./autocomplete.vue?vue&type=style&index=0&id=77c5e7a5&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../node_modules/stylus-loader/index.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./autocomplete.vue?vue&type=style&index=0&id=77c5e7a5&lang=stylus&scoped=true&\""],"sourceRoot":""}